@model IEnumerable<APOD.Models.APODModel>

@{
	ViewData["Title"] = "Index";
}

<div class="container">
	<div class="row">
		<h1 class="mb-5" style="color: cornflowerblue;"><b>NASA Image</b></h1>
		@foreach (var apod in Model)
		{
			<div class=" col-3 mb-5">
				<div class="card border-secondary h-100">

					<script>
						function showIframe(img, url) {
							var container = img.parentElement;
							var iframe = document.createElement("iframe");

							iframe.src = url;
							iframe.allowFullscreen = true;

							container.removeChild(img);
							container.appendChild(iframe);
						}
					</script>

					<div class="media-container">
						<img src="@Html.DisplayFor(item => apod.Url)" class="card-img-top" style="object-fit: cover; width: 300px; height: 150px" onerror="showIframe(this, '@apod.Url')">
					</div>

					<div class="card-body">
						<p class="card-title">@Html.DisplayFor(item => apod.Title)</p>

					</div>
					<div class="card-footer">
						<a asp-action="Details" asp-route-id="@apod.Id">보기</a>
					</div>
				</div>
			</div>
		}
	</div>
</div>


<form asp-controller="APOD" asp-action="Index" method="get">
	<div class="mt-3">
		<ul class="pagination">
			<button class="page-link" type="submit" name="page" value=1>&laquo;</button>
			@for (int i = 0; i < 5; i++)
			{
				if ((int)ViewData["CurrentPage"] == 1)
				{
					if ((int)ViewData["CurrentPage"] == (int)ViewData["CurrentPage"] + i)
					{
						<li class="page-item active">
							<button class="page-link" type="submit" name="page"
						value="@((int)ViewData["CurrentPage"] + i)">
								@(
									(int)ViewData["CurrentPage"] + i
									)
							</button>
						</li>
					}
					else
					{
						<button class="page-link" type="submit" name="page"
					value="@((int)ViewData["CurrentPage"] + i)">
							@((int)ViewData["CurrentPage"] + i)
						</button>
					}
				}

				else if ((int)ViewData["CurrentPage"] == 2)
				{
					if ((int)ViewData["CurrentPage"] == (int)ViewData["CurrentPage"] - 1 + i)
					{
						<li class="page-item active">
							<button class="page-link" type="submit" name="page"
						value="@((int)ViewData["CurrentPage"] - 1 + i)">
								@((int)ViewData["CurrentPage"] - 1 + i)
							</button>
						</li>
					}
					else
					{
						<button class="page-link" type="submit" name="page"
					value="@((int)ViewData["CurrentPage"] - 1 + i)">
							@((int)ViewData["CurrentPage"] - 1 + i)
						</button>
					}
				}

				else if ((int)ViewData["CurrentPage"] + i - 2 <= Convert.ToInt32(ViewData["TotalPage"]))
				{
					if ((int)ViewData["CurrentPage"] == (int)ViewData["CurrentPage"] - 2 + i)
					{
						<li class="page-item active">
							<button class="page-link" type="submit" name="page"
						value="@((int)ViewData["CurrentPage"] - 2 + i)">
								@((int)ViewData["CurrentPage"] - 2 + i)
							</button>
						</li>
					}
					else
					{

						<button class="page-link" type="submit" name="page"
					value="@((int)ViewData["CurrentPage"] - 2 + i)">
							@((int)ViewData["CurrentPage"] - 2 + i)
						</button>
					}
				}
			}
			<button class="page-link" type="submit" name="page" value="@ViewData["TotalPage"]">&raquo;</button>

		</ul>
	</div>
</form>