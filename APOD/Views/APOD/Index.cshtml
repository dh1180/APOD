@model IEnumerable<APOD.Models.APODModel>

@{
	ViewData["Title"] = "Index";
}

<script>
	function showIframe(img, url) {
		var container = img.parentElement;
		var iframe = document.createElement("iframe");

		iframe.src = url;
		iframe.allowFullscreen = true;

		container.removeChild(img);
		container.appendChild(iframe);
	}
</script>

<div class="container">
	<div class="row">
		<h1 class="mb-5" style="color: cornflowerblue;"><b>NASA Image</b></h1>
		@foreach (var apod in Model)
		{
			<div class=" col-3 mb-5">
				<div class="card border-secondary h-100">

					<div class="media-container">
						<img src="@Html.DisplayFor(item => apod.Url)" class="card-img-top" style="object-fit: cover; height: 150px" onerror="showIframe(this, '@apod.Url')">
					</div>

					<div class="card-body">
						<p class="card-title">@Html.DisplayFor(item => apod.Title)</p>

					</div>
					<div class="card-footer">
						<a style="text-decoration-line: none;" asp-action="Details" asp-route-id="@apod.Id">View</a>
					</div>
				</div>
			</div>
		}
	</div>
</div>


<form asp-controller="APOD" asp-action="Index" method="get">
	<div class="mt-3">
		<ul class="pagination">
			<button class="page-link" type="submit" name="page" value=1>&laquo;</button>
			@for (int i = 0; i < 5; i++)
			{
				if ((int)ViewData["CurrentPage"] == 1 && (int)ViewData["CurrentPage"] + i <= Convert.ToInt32(ViewData["TotalPage"]))
				{
					if ((int)ViewData["CurrentPage"] == (int)ViewData["CurrentPage"] + i)
					{
						<li class="page-item active">
							<button class="page-link" type="submit" name="page"
						value="@((int)ViewData["CurrentPage"] + i)">
								@(
									(int)ViewData["CurrentPage"] + i
									)
							</button>
						</li>
					}
					else
					{
						<button class="page-link" type="submit" name="page"
					value="@((int)ViewData["CurrentPage"] + i)">
							@((int)ViewData["CurrentPage"] + i)
						</button>
					}
				}

				else if ((int)ViewData["CurrentPage"] == 2 && (int)ViewData["CurrentPage"] - 1 + i <= Convert.ToInt32(ViewData["TotalPage"]))
				{
					if ((int)ViewData["CurrentPage"] == (int)ViewData["CurrentPage"] - 1 + i)
					{
						<li class="page-item active">
							<button class="page-link" type="submit" name="page"
						value="@((int)ViewData["CurrentPage"] - 1 + i)">
								@((int)ViewData["CurrentPage"] - 1 + i)
							</button>
						</li>
					}
					else
					{
						<button class="page-link" type="submit" name="page"
					value="@((int)ViewData["CurrentPage"] - 1 + i)">
							@((int)ViewData["CurrentPage"] - 1 + i)
						</button>
					}
				}

				else if ((int)ViewData["CurrentPage"] + i - 2 <= Convert.ToInt32(ViewData["TotalPage"])
				&& (int)ViewData["CurrentPage"] > 2)
				{
					if ((int)ViewData["CurrentPage"] == (int)ViewData["CurrentPage"] - 2 + i)
					{
						<li class="page-item active">
							<button class="page-link" type="submit" name="page"
						value="@((int)ViewData["CurrentPage"] - 2 + i)">
								@((int)ViewData["CurrentPage"] - 2 + i)
							</button>
						</li>
					}
					else
					{
							<button class="page-link" type="submit" name="page"
						value="@((int)ViewData["CurrentPage"] - 2 + i)">
								@((int)ViewData["CurrentPage"] - 2 + i)
							</button>
					}

				}
			}
			<button class="page-link" type="submit" name="page" value="@ViewData["TotalPage"]">&raquo;</button>

		</ul>
		<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3862816878614020"
				crossorigin="anonymous"></script>
		<!-- 반응형 -->
		<ins class="adsbygoogle"
			 style="display:block"
			 data-ad-client="ca-pub-3862816878614020"
			 data-ad-slot="3072248560"
			 data-ad-format="auto"
			 data-full-width-responsive="true"></ins>
		<script>
			(adsbygoogle = window.adsbygoogle || []).push({});
		</script>
	</div>
</form>